/** \file opticflow_ADNS3080.h
 *  \brief Handling of ADNS3080 optic flow sensor
 *
 */

#ifndef OPTFLOW_ADNS3080_H
#define OPTFLOW_ADNS3080_H


#ifdef USE_OPTFLOW_ADNS3080

#include "mcu_periph/uart.h"
#include "messages.h"
#include "downlink.h"

//register addresses
#define OPTFLOW_ADNS3080_ADDR_PROD_ID		0x00
#define OPTFLOW_ADNS3080_ADDR_REV_ID		0x01
#define OPTFLOW_ADNS3080_ADDR_MOTION		0x02
#define OPTFLOW_ADNS3080_ADDR_DX			0x03
#define OPTFLOW_ADNS3080_ADDR_DY			0x04
#define OPTFLOW_ADNS3080_ADDR_SQUAL			0x05
#define OPTFLOW_ADNS3080_ADDR_PIX_SUM		0x06
#define OPTFLOW_ADNS3080_ADDR_MAX_PIX		0x07
#define OPTFLOW_ADNS3080_ADDR_CONF			0x0a
#define OPTFLOW_ADNS3080_ADDR_EXCONF		0x0b
#define OPTFLOW_ADNS3080_ADDR_DO_LOW		0x0c
#define OPTFLOW_ADNS3080_ADDR_DO_UP			0x0d
#define OPTFLOW_ADNS3080_ADDR_SHUT_LO		0x0e
#define OPTFLOW_ADNS3080_ADDR_SHUT_UP		0x0f
#define OPTFLOW_ADNS3080_ADDR_FP_LO			0x10
#define OPTFLOW_ADNS3080_ADDR_FP_UP			0x11
#define OPTFLOW_ADNS3080_ADDR_MOTION_CLR	0x12
#define OPTFLOW_ADNS3080_ADDR_FRAMECAP		0x13
#define OPTFLOW_ADNS3080_ADDR_SROM_ENABLE	0x14
#define OPTFLOW_ADNS3080_ADDR_FP_MAX_B_LOW  0x19
#define OPTFLOW_ADNS3080_ADDR_FP_MAX_B_UP	0x1a
#define OPTFLOW_ADNS3080_ADDR_FP_MIN_B_LOW	0x1b
#define OPTFLOW_ADNS3080_ADDR_FP_MIN_B_UP   0x1c
#define OPTFLOW_ADNS3080_ADDR_SHUT_MAX_B_LOW 0x1d
#define OPTFLOW_ADNS3080_ADDR_SHUT_MAX_B_UP 0x1e
#define OPTFLOW_ADNS3080_ADDR_SROM_ID		0x1f
#define OPTFLOW_ADNS3080_ADDR_OBSERV		0x3d
#define OPTFLOW_ADNS3080_ADDR_INV_PROD_ID	0x3f
#define OPTFLOW_ADNS3080_ADDR_PIX_BURST		0x40
#define OPTFLOW_ADNS3080_ADDR_MOTION_BURST  0x50
#define OPTFLOW_ADNS3080_ADDR_SROM_LOAD		0x60


void optflow_ADNS3080_init(void);
void optflow_ADNS3080_spi_conf(void);
uint16_t optflow_ADNS3080_readRegister( uint16_t addr);
void optflow_ADNS3080_test(void);

#endif // USE_OPTFLOW_ADNS3080

#endif // OPTFLOW_ADNS3080_H
